{% comment %} 
live site: https://norseorganics.co/products/kill-acne-redness-ritual?variant=47373610877270 
{% endcomment %}

<section class="media-section">
  <div class="media-section-container">
    <h2>{{ section.settings.media_heading }}</h2>
    <p>{{ section.settings.media_subheading }}</p>
    <div class="slider-buttons">
      <button class="slider-button" onclick="scrollMedia(-1)">
        <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g opacity="1" filter="url(#filter0_d_1435_1006)">
          <rect x="10.8789" y="10.9648" width="59" height="59" rx="29.5" fill="white" shape-rendering="crispEdges"/>
          <rect x="11.3789" y="11.4648" width="58" height="58" rx="29" stroke="#E16203" shape-rendering="crispEdges"/>
          <path d="M44.8789 32.9648L36.8789 40.9648L44.8789 48.9648" stroke="#E16203" stroke-linecap="round" stroke-linejoin="round"/>
          </g>
          <defs>
          <filter id="filter0_d_1435_1006" x="0.878906" y="0.964844" width="79" height="79" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset/>
          <feGaussianBlur stdDeviation="5"/>
          <feComposite in2="hardAlpha" operator="out"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1435_1006"/>
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1435_1006" result="shape"/>
          </filter>
          </defs>
        </svg>
      </button>
      <button class="slider-button" onclick="scrollMedia(1)">
        <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g filter="url(#filter0_d_1435_1009)">
          <rect x="10.8789" y="10.9648" width="59" height="59" rx="29.5" fill="white" shape-rendering="crispEdges"/>
          <rect x="11.3789" y="11.4648" width="58" height="58" rx="29" stroke="#E16203" shape-rendering="crispEdges"/>
          <path d="M36.8789 32.9648L44.8789 40.9648L36.8789 48.9648" stroke="#E16203" stroke-linecap="round" stroke-linejoin="round"/>
          </g>
          <defs>
          <filter id="filter0_d_1435_1009" x="0.878906" y="0.964844" width="79" height="79" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix"/>
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
          <feOffset/>
          <feGaussianBlur stdDeviation="5"/>
          <feComposite in2="hardAlpha" operator="out"/>
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1435_1009"/>
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1435_1009" result="shape"/>
          </filter>
          </defs>
        </svg>
      </button>
    </div>
    <div class="media-grid hide-scrollbar" id="mediaSlider">
      {% for block in section.blocks %}
        <div class="media-item">
          {% if block.settings.media_logo != blank %}
            <img src="{{ block.settings.media_logo | img_url: 'medium' }}" alt="Media Logo">
          {% endif %}
          <p>{{ block.settings.media_quote }}</p>
        </div>
      {% endfor %}
    </div>
  </div>
</section>

<style>
  .media-section {
    text-align: center;
    padding: 60px 20px;
    background-image: url(https://cdn.shopify.com/s/files/1/0485/7787/2027/files/1D.png?v=1744891932);
    position: relative;
    background-size: cover;
  }
  .media-section-container {
    max-width: 1300px;
    margin: 0 auto;
  }
  .media-section h2 {
    font-size: 40px;
    color: black;
    font-family: 'Migra';
    font-weight: bold;
    margin-bottom: 8px;
  }

  .media-section p {
    font-size: 24px;
    font-family: 'PP Mori';
    line-height: 140%;
    margin-bottom: 20px;
  }

  .media-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 20px;
    justify-items: center;
  }
  .slider-buttons {
    display: none;
  }
  .hide-scrollbar {
    overflow-x: auto;
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* Internet Explorer 10+ */
  }

  .hide-scrollbar::-webkit-scrollbar {
    display: none; /* Chrome, Safari and Opera */
  }

  .media-item {
    background: white;
    border: 1px solid #1e262a40;
    padding: 12px;
    box-shadow: 0px 4px 4px 0px #00000040;
    text-align: center;
    margin-bottom: 5px;
    max-width: 227px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
  }

  .media-item img {
    max-height: 50px;
    width: auto;
    margin-bottom: 8px;
  }

  .media-item p {
    font-size: 14px;
  }

  @media (max-width: 768px) {
    .media-section {
      background-image: url(https://cdn.shopify.com/s/files/1/0485/7787/2027/files/1P.png?v=1744893591);
      position: relative;
      background-size: cover;
    }
    .media-grid {
      margin-bottom: 60px !important;
    }
  }

  @media (max-width: 1024px) {
    .media-section-container {
      overflow: hidden;
    }

    .media-grid {
      overflow-x: auto;
      scroll-behavior: smooth;
      gap: 16px;
      margin-bottom: 90px;
    }

    .media-item {
      min-width: 227px; /* Adjust based on your design */
      flex-shrink: 0;
      margin-bottom: 5px;
    }

    .slider-buttons {
      display: block;
      display: flex;
      justify-content: center;
      position: absolute;
      width: 100%;
      top: 90%;
      transform: translateY(-50%);
    }

    .slider-button {
      padding: 8px;
      cursor: pointer;
    }
  }
</style>

<script>
  const container = document.getElementById('mediaSlider');
  const leftBtn = document.querySelectorAll('.slider-button')[0];
  const rightBtn = document.querySelectorAll('.slider-button')[1];
  const itemWidth = container.querySelector('.media-item').offsetWidth + 16; // 16 is the gap

  function updateArrowStates() {
    const maxScrollLeft = container.scrollWidth - container.clientWidth;
    leftBtn.disabled = container.scrollLeft <= 0;
    rightBtn.disabled = container.scrollLeft >= maxScrollLeft - 5; // 5 for safe buffer

    // Optional: Change opacity or cursor to indicate disabled visually
    leftBtn.style.opacity = leftBtn.disabled ? '0.3' : '1';
    rightBtn.style.opacity = rightBtn.disabled ? '0.3' : '1';
    leftBtn.style.cursor = leftBtn.disabled ? 'not-allowed' : 'pointer';
    rightBtn.style.cursor = rightBtn.disabled ? 'not-allowed' : 'pointer';
  }

  function scrollMedia(direction) {
    container.scrollBy({
      left: direction * itemWidth * 2,
      behavior: 'smooth',
    });

    // Wait a bit for smooth scroll to finish then update buttons
    setTimeout(updateArrowStates, 300);
  }

  // Update on manual scroll (e.g., swipe)
  container.addEventListener('scroll', updateArrowStates);

  // Initial check
  window.addEventListener('load', updateArrowStates);
</script>

{% schema %}
{
  "name": "Media Mentions IW",
  "settings": [
    {
      "type": "text",
      "id": "media_heading",
      "label": "Heading",
      "default": "Media"
    },
    {
      "type": "textarea",
      "id": "media_subheading",
      "label": "Subheading",
      "default": "Recommended by magazines <br> and universities around the world"
    }
  ],
  "blocks": [
    {
      "type": "media_item",
      "name": "Media Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "media_logo",
          "label": "Media Logo"
        },
        {
          "type": "textarea",
          "id": "media_quote",
          "label": "Media Quote",
          "default": "Your media quote here."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Media Mentions IW",
      "category": "Custom Sections"
    }
  ]
}
{% endschema %}
